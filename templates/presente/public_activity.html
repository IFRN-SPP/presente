{% extends 'presente/base.html' %}
{% load static %}

{% block title %}{{ activity.title }}{% endblock %}

{% block body_class %}public-activity-page{% endblock %}

{% block extra_head %}
<script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
{% endblock %}

{% block app_wrapper %}
<div class="fullscreen-container">
  <div class="activity-card">
    <div class="activity-header">
      <h1><i class="bi bi-calendar-event"></i> {{ activity.title }}</h1>
    </div>

    <div class="activity-body">
      {% if activity.event %}
      <div class="event-info">
        <i class="bi bi-folder"></i> {{ activity.event.name }}
      </div>
      {% endif %}

      <div class="time-info">
        <div class="time-block">
          <div class="time-label"><i class="bi bi-clock"></i> Início</div>
          <div class="time-value">{{ activity.start_time|date:"d/m/Y H:i" }}</div>
        </div>
        <div class="time-block">
          <div class="time-label"><i class="bi bi-clock-fill"></i> Término</div>
          <div class="time-value">{{ activity.end_time|date:"d/m/Y H:i" }}</div>
        </div>
      </div>

      <div class="qr-section">
        <div class="qr-title">Registrar Presença</div>
        <div class="qr-subtitle">Escaneie o QR Code para registrar sua presença</div>

        <div id="qr-code-container"
             hx-get="{% url 'presente:activity_qr' encoded_id %}"
             hx-trigger="load"
             hx-swap="innerHTML">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Carregando...</span>
          </div>
        </div>

        <div class="instructions">
          <div class="instruction-item">
            <i class="bi bi-phone"></i>
            <span>Escaneie com seu celular</span>
          </div>
          <div class="instruction-item">
            <i class="bi bi-person-check"></i>
            <span>Faça login</span>
          </div>
          <div class="instruction-item">
            <i class="bi bi-check-circle"></i>
            <span>Presença registrada!</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
